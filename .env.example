# Application
NODE_ENV=development
PORT=8080

# Database
# Port 5433 is used on the host to avoid conflicts with local PostgreSQL installations (standard port 5432)
# Docker maps host port 5433 → container port 5432 (see docker-compose files)
# For local development: postgresql://postgres:password@localhost:5433/pmarbitrage?schema=public
# For Docker: postgresql://postgres:password@postgres:5432/pmarbitrage?schema=public
DATABASE_URL="postgresql://postgres:password@localhost:5433/pmarbitrage?schema=public"

# Trading Engine
POLLING_INTERVAL_MS=30000  # Polling cycle interval in milliseconds

# Kalshi API Configuration
KALSHI_API_KEY_ID=                          # Kalshi API Key ID (get from demo.kalshi.co dashboard)
KALSHI_PRIVATE_KEY_PATH=./secrets/key.pem   # Path to RSA private key in PEM format (NOT committed to git)
KALSHI_API_BASE_URL=https://demo-api.kalshi.co  # Demo: demo-api.kalshi.co | Prod: trading-api.kalshi.com

# Polymarket Configuration
POLYMARKET_PRIVATE_KEY=            # Wallet private key (hex, no 0x prefix)
POLYMARKET_CLOB_API_URL=https://clob.polymarket.com
POLYMARKET_WS_URL=wss://ws-subscriptions-clob.polymarket.com/ws/market
POLYMARKET_CHAIN_ID=137

# Edge Calculation (Story 3.3)
DETECTION_MIN_EDGE_THRESHOLD=0.008    # Minimum net edge threshold (decimal, 0.008 = 0.8%)
DETECTION_GAS_ESTIMATE_USD=0.30       # Static fallback gas estimate in USD (used when dynamic estimation unavailable)
DETECTION_POSITION_SIZE_USD=300       # Reference position size for edge % calculation

# Gas Estimation (Story 6.0) — dynamic gas estimation for Polymarket on-chain settlement
POLYMARKET_RPC_URL=https://polygon-rpc.com             # Polygon RPC endpoint for gas price queries
GAS_BUFFER_PERCENT=20                                   # Safety buffer applied to gas estimate (20 = 20%)
GAS_POLL_INTERVAL_MS=30000                              # Gas/POL price polling interval in milliseconds
GAS_POL_PRICE_FALLBACK_USD=0.40                         # Fallback POL/USD price if CoinGecko unavailable
POLYMARKET_SETTLEMENT_GAS_UNITS=150000                  # Gas units for CTF Exchange settlement tx

# Risk Management (Story 4.1)
RISK_BANKROLL_USD=10000               # Total bankroll in USD
RISK_MAX_POSITION_PCT=0.03            # Max position size as fraction of bankroll (0.03 = 3%)
RISK_MAX_OPEN_PAIRS=10                # Maximum simultaneous open arbitrage pairs
RISK_DAILY_LOSS_PCT=0.05              # Daily loss limit as fraction of bankroll (0.05 = 5%)

# Operator API Authentication (Story 4.3)
OPERATOR_API_TOKEN=dev-token-change-me  # Static Bearer token for operator dashboard endpoints

# Paper Trading Mode (Story 5.5.1)
PLATFORM_MODE_KALSHI=live              # Platform mode: live | paper (default: live)
PLATFORM_MODE_POLYMARKET=live          # Platform mode: live | paper (default: live)
PAPER_FILL_LATENCY_MS_KALSHI=150       # Simulated fill latency in ms (paper mode only)
PAPER_SLIPPAGE_BPS_KALSHI=5            # Simulated slippage in basis points (paper mode only)
PAPER_FILL_LATENCY_MS_POLYMARKET=800   # Simulated fill latency in ms (paper mode only, reflects on-chain)
PAPER_SLIPPAGE_BPS_POLYMARKET=15       # Simulated slippage in basis points (paper mode only)
ALLOW_MIXED_MODE=false                 # Allow one platform live + one paper (default: false)

# Telegram Alerts (Story 6.1) — real-time monitoring via Telegram Bot API
TELEGRAM_BOT_TOKEN=                            # Telegram bot token (from @BotFather)
TELEGRAM_CHAT_ID=                              # Telegram chat ID for alerts
TELEGRAM_TEST_ALERT_CRON=0 8 * * *            # Daily test alert cron (default: 8am UTC)
TELEGRAM_TEST_ALERT_TIMEZONE=UTC               # Timezone for test alert cron
TELEGRAM_SEND_TIMEOUT_MS=2000                  # HTTP timeout for Telegram API calls (ms)
TELEGRAM_MAX_RETRIES=3                         # Consecutive failures before circuit breaker opens
TELEGRAM_BUFFER_MAX_SIZE=100                   # Max buffered messages (priority queue)
TELEGRAM_CIRCUIT_BREAK_MS=60000                # Circuit breaker open duration (ms)

# CSV Trade Logging (Story 6.3) — trade logs and daily summaries
CSV_TRADE_LOG_DIR=./data/trade-logs            # Directory for daily CSV trade log files
CSV_ENABLED=true                                # Enable/disable CSV trade logging
# Daily summary runs at UTC midnight (hardcoded @Cron in DailySummaryService)

# Compliance Validation (Story 6.4) — trade gating against compliance matrix
COMPLIANCE_MATRIX_CONFIG_PATH=config/compliance-matrix.yaml  # Path to compliance matrix YAML config

# Dashboard (Story 7.1) — operator dashboard CORS origin
DASHBOARD_ORIGIN=http://localhost:5173    # Dashboard SPA origin for CORS (dev default)
